using System;
using System.Globalization;
using System.Linq;
using System.Text;
using System.Windows.Forms;

static class Program
{
    // Crea un TextBox con validación para números decimales
    static TextBox CrearCajaTexto(int x, int y)
    {
        TextBox txt = new TextBox();
        txt.Size = new System.Drawing.Size(50, 30);
        txt.Location = new System.Drawing.Point(x, y);
        txt.TextAlign = HorizontalAlignment.Center;

        // Permite solo dígitos, control y un separador decimal
        txt.KeyPress += (s, e) =>
        {
            char sep = Convert.ToChar(CultureInfo.CurrentCulture.NumberFormat.NumberDecimalSeparator);
            if (!char.IsControl(e.KeyChar) && !char.IsDigit(e.KeyChar) && e.KeyChar != sep)
                e.Handled = true;
            if (e.KeyChar == sep && txt.Text.Contains(sep))
                e.Handled = true;
        };

        return txt;
    }

    // Intenta convertir texto a decimal, devuelve true si es válido
    static bool EsDecimalValido(string texto, out double valor)
    {
        return double.TryParse(texto, out valor);
    }

    [STAThread]
    static void Main()
    {
        Application.EnableVisualStyles();
        Application.SetCompatibleTextRenderingDefault(false);

        // Configuración básica del formulario
        Form form = new Form();
        form.Text = "Buscar número en matriz";
        form.StartPosition = FormStartPosition.CenterScreen;
        form.ClientSize = new System.Drawing.Size(380, 420);

        // Etiqueta con instrucciones para el usuario
        Label lblInfo = new Label();
        lblInfo.Text = "Ingresa números decimales en la matriz 3x3:";
        lblInfo.Location = new System.Drawing.Point(40, 10);
        lblInfo.AutoSize = true;
        form.Controls.Add(lblInfo);

        // Crear matriz 3x3 de TextBoxes para ingresar números
        TextBox[,] matriz = new TextBox[3, 3];
        int startX = 70, startY = 40;

        for (int fila = 0; fila < 3; fila++)
            for (int col = 0; col < 3; col++)
            {
                int x = startX + col * 60;
                int y = startY + fila * 60;
                matriz[fila, col] = CrearCajaTexto(x, y);
                form.Controls.Add(matriz[fila, col]);
            }

        // Caja para ingresar el número que se desea buscar
        Label lblBuscar = new Label();
        lblBuscar.Text = "Número a buscar:";
        lblBuscar.Location = new System.Drawing.Point(40, 240);
        lblBuscar.AutoSize = true;
        form.Controls.Add(lblBuscar);

        TextBox txtBuscar = CrearCajaTexto(160, 235);
        form.Controls.Add(txtBuscar);

        // Botón para ejecutar la búsqueda
        Button btnBuscar = new Button();
        btnBuscar.Text = "Buscar";
        btnBuscar.Size = new System.Drawing.Size(120, 30);
        btnBuscar.Location = new System.Drawing.Point(125, 280);
        form.Controls.Add(btnBuscar);

        // Evento clic del botón Buscar
        btnBuscar.Click += (s, e) =>
        {
            // Validar número buscado
            if (!EsDecimalValido(txtBuscar.Text, out double objetivo))
            {
                MessageBox.Show("Ingresa un número válido para buscar.");
                return;
            }

            StringBuilder resultado = new StringBuilder();
            bool encontrado = false;

            // Recorrer toda la matriz para buscar el número
            for (int fila = 0; fila < 3; fila++)
            {
                for (int col = 0; col < 3; col++)
                {
                    string texto = matriz[fila, col].Text;

                    // Validar cada celda
                    if (!EsDecimalValido(texto, out double valor))
                    {
                        MessageBox.Show($"Número inválido en la celda ({fila + 1}, {col + 1}).");
                        return;
                    }

                    // Si coincide con el número buscado, anotar posición
                    if (valor == objetivo)
                    {
                        encontrado = true;
                        resultado.AppendLine($"Fila {fila + 1}, Columna {col + 1}");
                    }
                }
            }

            // Mostrar posiciones encontradas o mensaje si no existe
            MessageBox.Show(encontrado ? resultado.ToString() : "No se encontró el número.");
        };

        Application.Run(form);
    }
}
